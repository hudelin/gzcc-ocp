<!DOCTYPE html>
<html>
<head>
    <base href="${request.scheme+'://'+request.serverName+':'+request.serverPort+'/'+ctxPath}"/>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>layout 后台大布局 - Layui</title>
    <link rel="stylesheet" href="../../res/layui/css/layui.css">
</head>
<body class="layui-layout-body">
<div class="layui-layout layui-layout-admin">

    <table id="demo" lay-filter="test"></table>
</div>


<script src="../../res/layui/layui.js"></script>


<script type="text/html" id="genderTemplate">
    <!-- 这里的 checked 的状态只是演示 -->
    <!--<input type="checkbox" name="sex" value="{{d.id}}" lay-skin="switch" lay-text="女|男" lay-filter="sexDemo" {{ d.id == 10003 ? 'checked' : '' }}>-->
    {{d.gender=='0'?"男":"女"}}
</script>
<script type="text/html" id="barDemo">
    <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
    <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
</script>
<script>
    layui.use('table', function(){
        var table = layui.table;

        //第一个实例
        table.render({
            elem: '#demo'
            // ,height: 312
            ,height: 'full-20'

            ,url: '/user/findUserPage' //数据接口
            ,cellMinWidth: 80
            ,toolbar: true
            ,page: true //开启分页
            ,request: {
                pageName: 'page' //页码的参数名称，默认：page
                ,limitName: 'size' //每页数据量的参数名，默认：limit
            }
            ,parseData: function(res){ //res 即为原始返回的数据
                console.log(res)
                return {
                    "code": "0", //解析接口状态
                    "msg": res.message, //解析提示文本
                    "count": res.totalElements, //解析数据长度
                    "data": res.content //解析数据列表
                };
            }
            ,cols: [[ //表头
                {type:'checkbox'}
                ,{field: 'id', title: 'ID',  sort: true}
                ,{field: 'username', title: '用户名'}
                ,{field: 'gender', title: '性别', sort: true, templet: '#genderTemplate'}
                ,{field: 'email', title: '城市',edit: 'text'}
                ,{field: 'sign', title: '签名'}
                ,{field: 'experience', title: '积分', sort: true}
                ,{field: 'score', title: '评分',  sort: true}
                ,{field: 'classify', title: '职业'}
                ,{fixed: 'right', title:'操作', toolbar: '#barDemo', width:150}
            ]]
            ,
        });

        //监听单元格编辑
        table.on('edit(test)', function(obj){
            var value = obj.value //得到修改后的值
                ,data = obj.data //得到所在行所有键值
                ,field = obj.field; //得到字段
            layer.msg('[ID: '+ data.id +'] ' + field + ' 字段更改为：'+ value);
        });

    });
</script>


</body>
</html>
